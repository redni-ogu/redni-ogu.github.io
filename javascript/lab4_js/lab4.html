<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Тестирование класса Book</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
    }
    .container {
      display: flex;
      flex-direction: column;
      gap: 20px;
    }
    .section {
      border: 1px solid #ccc;
      padding: 10px;
      border-radius: 5px;
    }
    button {
      padding: 5px 10px;
      margin: 5px;
      cursor: pointer;
    }
    pre {
      background-color: #f4f4f4;
      padding: 10px;
      border-radius: 5px;
      overflow-x: auto;
    }
  </style>
</head>
<body>
  <h1>Тестирование класса Book</h1>
  <div class="container">
    <div class="section">
      <h2>Создание книги</h2>
      <button onclick="createBook()">Создать книгу</button>
      <pre id="bookCreationOutput"></pre>
    </div>

    <div class="section">
      <h2>Изменение свойств книги</h2>
      <button onclick="modifyBook()">Изменить свойства</button>
      <pre id="bookModificationOutput"></pre>
    </div>

    <div class="section">
      <h2>Сортировка книг</h2>
      <button onclick="sortBooks()">Сортировать книги</button>
      <pre id="bookSortingOutput"></pre>
    </div>

    <div class="section">
      <h2>Проверка на пустоту</h2>
      <button onclick="checkEmpty()">Проверить пустоту</button>
      <pre id="emptyCheckOutput"></pre>
    </div>

    <div class="section">
      <h2>Работа с классами</h2>
      <button onclick="manageClasses()">Управление классами</button>
      <pre id="classManagementOutput"></pre>
    </div>

    <div class="section">
      <h2>Преобразование в JSON</h2>
      <button onclick="convertToJson()">Преобразовать в JSON</button>
      <pre id="jsonConversionOutput"></pre>
    </div>

    <div class="section">
      <h2>Время и дата</h2>
      <button onclick="getTimeAndDate()">Получить время и дату</button>
      <pre id="timeAndDateOutput"></pre>
    </div>
  </div>

  <script>
    // 1. Класс Book с конструктором и методом show
    class Book {
      constructor(title, pubYear, price) {
        this.title = title;
        this.pubYear = pubYear;
        this.price = price;
      }

      show() {
        console.log(`Название: ${this.title}, Цена: ${this.price}`);
      }

      // 2. Геттеры и сеттеры с проверками
      get title() {
        return this._title;
      }

      set title(value) {
        if (typeof value === 'string' && value.trim() !== '') {
          this._title = value;
        } else {
          throw new Error('Название не может быть пустым');
        }
      }

      get pubYear() {
        return this._pubYear;
      }

      set pubYear(value) {
        if (typeof value === 'number' && value > 0) {
          this._pubYear = value;
        } else {
          throw new Error('Год публикации должен быть положительным числом');
        }
      }

      get price() {
        return this._price;
      }

      set price(value) {
        if (typeof value === 'number' && value > 0) {
          this._price = value;
        } else {
          throw new Error('Цена должна быть положительным числом');
        }
      }

      // 3. Статический метод compare
      static compare(a, b) {
        return a.pubYear - b.pubYear;
      }
    }

    // 4. Функция isEmpty
    function isEmpty(obj) {
      for (const key in obj) {
        if (obj.hasOwnProperty(key)) {
          return false;
        }
      }
      return Object.getOwnPropertySymbols(obj).length === 0;
    }

    // 5. Объект с методами addClass и removeClass
    let obj = {
      className: 'open menu',

      addClass(cls) {
        if (!this.className.split(' ').includes(cls)) {
          this.className = this.className ? `${this.className} ${cls}` : cls;
        }
        return this;
      },

      removeClass(cls) {
        const classes = this.className.split(' ').filter(c => c !== cls);
        this.className = classes.join(' ');
        return this;
      }
    };

    // 6. Преобразование в JSON и обратно
    function convertToJson() {
      const jsonString = JSON.stringify(obj, null, 2);
      document.getElementById('jsonConversionOutput').textContent = jsonString;

      const obj2 = JSON.parse(jsonString);
      console.log(JSON.stringify(obj) === JSON.stringify(obj2)); // true
    }

    // 7. Функция getSecondsToday
    function getSecondsToday() {
      const now = new Date();
      const today = new Date(now.getFullYear(), now.getMonth(), now.getDate());
      return Math.floor((now - today) / 1000);
    }

    // 8. Функция formatDate
    function formatDate(date) {
      const day = String(date.getDate()).padStart(2, '0');
      const month = String(date.getMonth() + 1).padStart(2, '0');
      const year = String(date.getFullYear()).slice(-2);

      return `${day}.${month}.${year}`;
    }

    // Функции для тестирования
    function createBook() {
      const book1 = new Book('JavaScript', 2020, 500);
      book1.show();
      document.getElementById('bookCreationOutput').textContent = `Название: ${book1.title}, Цена: ${book1.price}`;
    }

    function modifyBook() {
      const book1 = new Book('JavaScript', 2020, 500);
      try {
        book1.title = 'Новый JavaScript';
        book1.pubYear = 2022;
        book1.price = 600;
        document.getElementById('bookModificationOutput').textContent = `Название: ${book1.title}, Год: ${book1.pubYear}, Цена: ${book1.price}`;
      } catch (e) {
        document.getElementById('bookModificationOutput').textContent = e.message;
      }
    }

    function sortBooks() {
      const books = [
        new Book('Книга 1', 2019, 300),
        new Book('Книга 2', 2018, 400),
        new Book('Книга 3', 2021, 350)
      ];

      books.sort(Book.compare);
      document.getElementById('bookSortingOutput').textContent = JSON.stringify(books, null, 2);
    }

    function checkEmpty() {
      const result1 = isEmpty({});
      const result2 = isEmpty({ [Symbol()]: true });
      document.getElementById('emptyCheckOutput').textContent = `Пустой объект: ${result1}\nОбъект с символом: ${result2}`;
    }

    function manageClasses() {
      obj.addClass('new').removeClass('open');
      document.getElementById('classManagementOutput').textContent = obj.className;
    }

    function getTimeAndDate() {
      const secondsToday = getSecondsToday();
      const formattedDate = formatDate(new Date());
      document.getElementById('timeAndDateOutput').textContent = `Секунды с начала дня: ${secondsToday}\nТекущая дата: ${formattedDate}`;
    }
  </script>
</body>
</html>
